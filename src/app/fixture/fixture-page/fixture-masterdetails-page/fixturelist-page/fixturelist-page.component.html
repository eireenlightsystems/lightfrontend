<div class="fr">

  <div *ngIf="isAdd">
    <jqxTooltip [position]="'bottom'" [name]="'addTooltip'"
                [content]="'Добавить светильник'">
      <Button [disabled]="isAddBtnDisabled"
              (click)="ins()"
              class="button_margin btn btn-small waves-effect waves-orange white blue-text"
      >
        <i class="material-icons">add</i>
      </Button>
    </jqxTooltip>
  </div>

  <div *ngIf="isUpdate">
    <jqxTooltip [position]="'bottom'" [name]="'updTooltip'"
                [content]="'Редактировать светильник'">
      <Button [disabled]="isEditBtnDisabled"
              (click)="upd()"
              class="button_margin btn btn-small waves-effect waves-orange white blue-text"
      >
        <i class="material-icons">edit</i>
      </Button>
    </jqxTooltip>
  </div>

  <div *ngIf="isDelete">
    <jqxTooltip [position]="'bottom'" [name]="'delTooltip'"
                [content]="'Удалить светильник'">
      <Button [disabled]="isDeleteBtnDisabled"
              (click)="del()"
              class="button_margin btn btn-small waves-effect waves-orange white blue-text"
      >
        <i class="material-icons">delete</i>
      </Button>
    </jqxTooltip>
  </div>

  <div *ngIf="isRefresh">
    <jqxTooltip [position]="'bottom'" [name]="'refreshTooltip'"
                [content]="'Обновить таблицу'">
      <button [disabled]="isRefreshBtnDisabled"
              (click)="refreshGrid()"
              class="button_margin btn btn-small waves-effect waves-orange white blue-text"
      >
        <i class="small material-icons">refresh</i>
      </button>
    </jqxTooltip>
  </div>

  <div *ngIf="isFilter_none">
    <jqxTooltip [position]="'bottom'" [name]="'fieldTooltip'"
                [content]="'Открыть фильтр по полям таблицы'">
      <button [disabled]="isFilter_noneBtnDisabled"
              (click)="fixturelistJqxgridComponent.islistBoxVisible = !fixturelistJqxgridComponent.islistBoxVisible"
              class="button_margin btn btn-small waves-effect waves-orange white blue-text"
      >
        <i class="material-icons">filter_none</i>
      </button>
    </jqxTooltip>
  </div>

  <div *ngIf="isFilter_list">
    <jqxTooltip [position]="'bottom'" [name]="'filterTooltip'"
                [content]="'Открыть фильтр'">
      <button [disabled]="isFilter_listBtnDisabled"
              (click)="isFilterVisible = !isFilterVisible"
              class="button_margin btn btn-small waves-effect waves-orange white blue-text"
              [ngClass]="{
      'active':isFilterVisible
    }"
      >
        <i class="material-icons">filter_list</i>
      </button>
    </jqxTooltip>
  </div>

  <div *ngIf="isPlace">
    <jqxTooltip [position]="'bottom'" [name]="'placeTooltip'"
                [content]="'Привязать светильник к узлу/столбу'">
      <button [disabled]="isPlaceBtnDisabled"
              (click)="place()"
              class="button_margin btn btn-small waves-effect waves-orange white blue-text"
      >
        <i class="small material-icons">place</i>
      </button>
    </jqxTooltip>
  </div>

  <div *ngIf="isPin_drop">
    <jqxTooltip [position]="'bottom'" [name]="'pin_dropTooltip'"
                [content]="'Отвязать светильник от узла/столба'">
      <button [disabled]="isPin_dropBtnDisabled"
              (click)="pin_drop()"
              class="button_margin btn btn-small waves-effect waves-orange white blue-text"
      >
        <i class="small material-icons">pin_drop</i>
      </button>
    </jqxTooltip>
  </div>

  <div *ngIf="isGroup_in">
    <jqxTooltip [position]="'bottom'" [name]="'filterTooltip'"
                [content]="'Добавить светильники в группу'">
      <button [disabled]="isGroup_inBtnDisabled"
              class="button_margin btn btn-small waves-effect waves-orange white blue-text"
              (click)="group_in()"
      >
        <i class="material-icons">file_download</i>
      </button>
    </jqxTooltip>
  </div>

  <div *ngIf="isGroup_out">
    <jqxTooltip [position]="'bottom'" [name]="'filterTooltip'"
                [content]="'Удалить светильники из группы'">
      <button [disabled]="isGroup_outBtnDisabled"
              class="button_margin btn btn-small waves-effect waves-orange white blue-text"
              (click)="group_out()"
      >
        <i class="material-icons">file_upload</i>
      </button>
    </jqxTooltip>
  </div>

</div>

<app-fixturelist-filter
  *ngIf="isFilterVisible"
  (onFilter)="applyFilter($event)"
  [geographs]="geographs"
  [ownerFixtures]="ownerFixtures"
  [fixtureTypes]="fixtureTypes"
  [substations]="substations"

  [selectContractId]="selectContractId"
  [selectNodeId]="selectNodeId"
></app-fixturelist-filter>

<div *ngIf="!reloading; else reloadingBlock">
  <!--*ngIf="fixtures.length > 0; else empty"-->
  <div>
    <app-fixturelist-jqxgrid #fixturelistJqxgridComponent
                             [fixtures]="fixtures"
                             [columnsFixture]="columnsFixture"
                             [listBoxSourceFixture]="listBoxSourceFixture"

                             [geographs]="geographs"
                             [ownerFixtures]="ownerFixtures"
                             [fixtureTypes]="fixtureTypes"
                             [substations]="substations"
                             [contractFixtures]="contractFixtures"
                             [installers]="installers"
                             [heightTypes]="heightTypes"

                             [heightGrid]="heightGrid"
                             [selectionmode]="selectionmode"
                             [isMasterGrid]="isMasterGrid"

                             [selectFixtureId]="selectFixtureId"
                             [selectContractId]="selectContractId"
                             [selectNodeId]="selectNodeId"

                             (onRefreshGrid)="refreshGrid()"
                             (onRefreshChildGrid)="refreshChildGrid($event)"
    ></app-fixturelist-jqxgrid>
    <div
      class="center mb2"
      *ngIf="!noMoreFixtures; else "
    >
      <!--<button-->
      <!--class="btn waves-effect grey darken-1 btn-small"-->
      <!--(click)="loadMore()"-->
      <!--*ngIf="!loading; else loader"-->
      <!--&gt;-->
      <!--Загрузить еще-->
      <!--</button>-->
      <ng-template #loader>
        <app-loader></app-loader>
      </ng-template>
    </div>
  </div>
  <ng-template #empty>
    <div class="center">Светильников пока нет</div>
  </ng-template>
</div>

<ng-template #reloadingBlock>
  <app-loader></app-loader>
</ng-template>


<app-fixture-grlink-form #linkWindow
                   [columns]="columnsFixture"
                   [fixtureGroupId]="fixtureGroupId"

                   (onSaveLinkwinBtn)="saveLinkwinBtn()"
></app-fixture-grlink-form>

<app-event-window #eventWindow
                  [warning]="warningEventWindow"
                  (onOkEvenwinBtn)="okEvenwinBtn()"
></app-event-window>
